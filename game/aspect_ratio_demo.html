<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aspect Ratio Fix Demonstration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        .panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .panel h2 {
            margin-top: 0;
            color: #555;
            text-align: center;
        }
        .before h2 {
            color: #d32f2f;
        }
        .after h2 {
            color: #388e3c;
        }
        canvas {
            border: 2px solid #ddd;
            display: block;
            margin: 10px auto;
        }
        .info {
            text-align: center;
            font-size: 14px;
            color: #666;
            margin: 5px 0;
        }
        .label {
            font-weight: bold;
            margin-top: 10px;
        }
        .code {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üçé Fruit Aspect Ratio Fix Demonstration</h1>
    <p style="text-align: center; color: #666;">
        Comparison showing how fruit illustrations are rendered before and after the aspect ratio fix
    </p>
    
    <div class="comparison">
        <div class="panel before">
            <h2>‚ùå BEFORE (Distorted)</h2>
            <div class="code">
                // Force square dimensions<br>
                const size = scaledRadius * 2;<br>
                drawImage(img, -size/2, -size/2, size, size);
            </div>
            <canvas id="canvas-before" width="200" height="200"></canvas>
            <div class="info">Images are stretched to fit square</div>
            <div class="info">‚ö†Ô∏è Aspect ratio NOT preserved</div>
        </div>
        
        <div class="panel after">
            <h2>‚úÖ AFTER (Correct)</h2>
            <div class="code">
                // Preserve aspect ratio<br>
                const aspect = img.width / img.height;<br>
                if (aspect > 1) {<br>
                &nbsp;&nbsp;w = size; h = size / aspect;<br>
                } else {<br>
                &nbsp;&nbsp;h = size; w = size * aspect;<br>
                }
            </div>
            <canvas id="canvas-after" width="200" height="200"></canvas>
            <div class="info">Images maintain natural proportions</div>
            <div class="info">‚úÖ Aspect ratio preserved</div>
        </div>
    </div>
    
    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0;">
        <h3 style="margin-top: 0;">üìä Example: Strawberry</h3>
        <p><strong>Original dimensions:</strong> 591√ó693 pixels (aspect ratio: 0.853)</p>
        <p><strong>Before fix:</strong> Forced into 200√ó200 square ‚Üí <span style="color: #d32f2f;">stretched horizontally</span></p>
        <p><strong>After fix:</strong> Rendered as 170.6√ó200 ‚Üí <span style="color: #388e3c;">maintains 0.853 aspect ratio ‚úì</span></p>
    </div>
    
    <script>
        // Simulate fruit image with non-square aspect ratio
        // Using strawberry dimensions: 591x693 (taller than wide)
        const createTestImage = () => {
            const canvas = document.createElement('canvas');
            canvas.width = 591;
            canvas.height = 693;
            const ctx = canvas.getContext('2d');
            
            // Draw a simple strawberry-like shape
            ctx.fillStyle = '#FF6347';
            ctx.beginPath();
            ctx.ellipse(295, 346, 250, 300, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Add some detail
            ctx.fillStyle = '#90EE90';
            ctx.fillRect(245, 50, 100, 80);
            
            // Add dots
            ctx.fillStyle = '#FFD700';
            for (let i = 0; i < 20; i++) {
                const x = 150 + Math.random() * 300;
                const y = 200 + Math.random() * 400;
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, Math.PI * 2);
                ctx.fill();
            }
            
            return canvas;
        };
        
        const testImg = createTestImage();
        
        // BEFORE: Force into square (distorted)
        const canvasBefore = document.getElementById('canvas-before');
        const ctxBefore = canvasBefore.getContext('2d');
        ctxBefore.fillStyle = '#fff7ed';
        ctxBefore.fillRect(0, 0, 200, 200);
        
        // Draw circle outline
        ctxBefore.strokeStyle = '#b45309';
        ctxBefore.lineWidth = 2;
        ctxBefore.beginPath();
        ctxBefore.arc(100, 100, 95, 0, Math.PI * 2);
        ctxBefore.stroke();
        
        // OLD METHOD: Force square
        const sizeBefore = 190;
        ctxBefore.drawImage(testImg, 5, 5, sizeBefore, sizeBefore);
        
        // AFTER: Preserve aspect ratio
        const canvasAfter = document.getElementById('canvas-after');
        const ctxAfter = canvasAfter.getContext('2d');
        ctxAfter.fillStyle = '#fff7ed';
        ctxAfter.fillRect(0, 0, 200, 200);
        
        // Draw circle outline
        ctxAfter.strokeStyle = '#b45309';
        ctxAfter.lineWidth = 2;
        ctxAfter.beginPath();
        ctxAfter.arc(100, 100, 95, 0, Math.PI * 2);
        ctxAfter.stroke();
        
        // NEW METHOD: Preserve aspect ratio
        const containerSize = 190;
        const imgAspect = testImg.width / testImg.height;
        let drawWidth, drawHeight;
        
        if (imgAspect > 1) {
            drawWidth = containerSize;
            drawHeight = containerSize / imgAspect;
        } else {
            drawHeight = containerSize;
            drawWidth = containerSize * imgAspect;
        }
        
        const offsetX = (200 - drawWidth) / 2;
        const offsetY = (200 - drawHeight) / 2;
        
        ctxAfter.drawImage(testImg, offsetX, offsetY, drawWidth, drawHeight);
        
        console.log('Test image aspect ratio:', imgAspect.toFixed(3));
        console.log('Before: forced to', sizeBefore + 'x' + sizeBefore);
        console.log('After: rendered as', drawWidth.toFixed(1) + 'x' + drawHeight.toFixed(1));
        console.log('Aspect preserved:', (drawWidth / drawHeight).toFixed(3), '‚âà', imgAspect.toFixed(3));
    </script>
</body>
</html>
